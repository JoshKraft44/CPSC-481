<!DOCTYPE html>
<html>
<head>
  <title>Student Verification</title>
  <style>
    img {
      width: 300px;
    }

    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 25px;
      margin: 35px auto;
      max-width: 900px;
    }

    .btn-group {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .btn-group-2 {
     display: flex;
     justify-content: center;
     align-items: center;
     gap: 10px;
     margin: 50px auto;
    }

    input[type="text"] {
      width: 200px;
      font-size: 30px;
      padding: 12px;
      border: 2px solid black;
      text-align: center;
      border-radius: 5px;
    }

    .entry-row {
      display: flex;
      align-items: center;
      gap: 20px;
      justify-content: center;
      margin-top: 10px;
    }

    .btn-number {
      font-size: 28px;
      padding: 15px 20px;
      background-color: white;
      color: black;
      border: 2px solid black;
      cursor: pointer;
      margin: 5px;
      width: 60px;
      height: 60px;
    }

    .link-button {
      display: inline-block;
      background-color: white;
      color: black;
      text-decoration: none;
      border: 2px solid black;
      font-size: 30px;
      width: 400px;
      text-align: center;
      padding-top: 30px;
      padding-bottom: 30px;
      margin: 10px;
    }

    .backspace-btn {
      font-size: 24px;
      padding: 14px 20px;
      background-color: white;
      border: 2px solid black;
      cursor: pointer;
    }

    .error-message {
      color: red;
      font-size: 20px;
      margin-top: 10px;
      display: none;
    }
  </style>
</head>
<body>
<div style="text-align: center;">
    <img src="coc-logo.svg" style="padding-bottom: 10px;"/>
    <h1>Verify Student Identity</h1>
    </div>

    <div class="container">
    <label for="studentID" style="font-size: 28px; margin-top: -5px;"><b>Enter your 7-digit Student ID Number</b></label>
    <div class="entry-row">
        <input id="studentID" placeholder="Student ID" type="text" maxlength="7" required />
        <button class="backspace-btn" id="backspace">âŒ«</button>
    </div>
    <div id="errorMessage" class="error-message">Please enter a valid 7-digit student ID</div>
    </div>

    <div class="container" style="gap: 20px;">
    <div class="btn-group">
        <button class="btn-number" data-num="1">1</button>
        <button class="btn-number" data-num="2">2</button>
        <button class="btn-number" data-num="3">3</button>
        <button class="btn-number" data-num="4">4</button>
        <button class="btn-number" data-num="5">5</button>
    </div>
    <div class="btn-group" style="margin-top: 0px;">
        <button class="btn-number" data-num="6">6</button>
        <button class="btn-number" data-num="7">7</button>
        <button class="btn-number" data-num="8">8</button>
        <button class="btn-number" data-num="9">9</button>
        <button class="btn-number" data-num="0">0</button>
    </div>

        <a class="link-button" onclick="finishVerification()" style="margin-top: 30px;">Confirm</a>
    
  
    <p style="text-align: center; margin-top: -4px;">________________________________________________________________________________________________________________</p>
  
    <div class="btn-group-2" style="margin-top: 52px;">
      <a class="link-button" href="PressToBegin.html">Cancel [X]</a>
      <button class="link-button" onclick="openGuide()" style="width: 60px; height: 100px; font-size: 24px; margin-left: 0px;">?</button>
    </div>
  
  <div id="guidePopup" style="display:none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80vw; max-height: 80vh; overflow-y: auto; padding: 30px; background: white; border: 2px solid black; z-index: 1000; font-size: 18px; line-height: 1.5; text-align: left;">
    <h2>Bus Ticketing Kiosk: Quick Guide</h2>
    <p>Welcome! This kiosk helps you easily purchase bus tickets, reload transit cards, or check schedules...</p>
    <button onclick="closeGuide()" style="margin-top: 20px; display: block;">Close</button>
  </div>

  <script>
    const studentIDInput = document.getElementById('studentID');
    const errorMessage = document.getElementById('errorMessage');
    const confirmButton = document.querySelector('.link-button[onclick="finishVerification()"]');

    document.querySelectorAll('.btn-number').forEach(button => {
      button.addEventListener('click', function () {
        if (studentIDInput.value.length < 7) {
          studentIDInput.value += this.textContent;
          errorMessage.style.display = 'none';
        }
      });
    });

    document.getElementById('backspace').addEventListener('click', function () {
      studentIDInput.value = studentIDInput.value.slice(0, -1);
      errorMessage.style.display = 'none';
    });

    function finishVerification() {
      const studentID = studentIDInput.value;

      // Validate the student ID
      if (studentID.length === 7 && /^\d+$/.test(studentID)) {
        // Store the student ID in sessionStorage
        sessionStorage.setItem('studentID', studentID);

        // Determine the next screen based on purchaseType
        const purchaseType = sessionStorage.getItem('purchaseType');
        if (purchaseType === 'ticket') {
          window.location.href = "Confirm_Ticket_Payment.html";
        } else if (purchaseType === 'pass') {
          window.location.href = "Confirm_Pass_Payment.html";
        } else {
          console.error("Invalid purchase type. Redirecting to home.");
          window.location.href = "PressToBegin.html"; // Fallback to home screen
        }
      } else {
        // Show error message if validation fails
        errorMessage.style.display = 'block';
      }
    }

    function openGuide() {
      document.getElementById('guidePopup').style.display = 'block';
    }

    function closeGuide() {
      document.getElementById('guidePopup').style.display = 'none';
    }
  </script>
</body>
</html>
